---
sectionclass: h2
sectionid: acr
parent-id: devops
title: DevOps - Create private highly available container registry 
---

Instead of using the public Docker Hub registry, create your own private container registry using Azure Container Registry (ACR).

### Tasks

#### Create an Azure Container Registry (ACR)

{% collapsible %}

```sh
az acr create --resource-group akschallenge --name <unique-acr-name> --sku Standard --location eastus
```

{% endcollapsible %}

#### Use Azure Container Registry Build to push the container images to your new registry

{% collapsible %}

Login to the registry

```sh
az acr login --name <unique-acr-name>
```

Clone the application code locally (or on Azure Cloud Shell)

```sh
git clone https://github.com/Azure/azch-captureorder.git
cd azch-captureorder
```

Use Azure Container Registry Build to build and push the container images

```sh
az acr build -t captureorder:{% raw %}{{.Run.ID}}{% endraw %} -r <unique-acr-name> .
```

> **Note** You'll get a build ID in a message simliar to ``Run ID: ca3 was successful after 3m14s``. Use `ca3` in this example as the image tag in the next step.

{% endcollapsible %}

#### Configure your application to pull from your private registry

{% collapsible %}

Authorize the AKS cluster to connect to the Azure Container Registry. Follow the instructions that [grant access using Azure Active Directory Service Principals](https://docs.microsoft.com/en-us/azure/container-registry/container-registry-auth-aks).

Replace the image tag with the location of the new image on Azure Container Registry. Replace `<build id>` with the ID you got from the message simliar to ``Run ID: ca3 was successful after 3m14s`` after the build was completed.

```yaml
spec:
    containers:
      - name: captureorder
        image: <unique-acr-name>.azurecr.io/captureorder:<build id>
```

{% endcollapsible %}

> **Resources**
> * <https://docs.microsoft.com/en-us/azure/container-registry>
> * <https://docs.microsoft.com/en-us/azure/container-registry/container-registry-auth-aks>
> * <https://docs.microsoft.com/en-us/cli/azure/acr?view=azure-cli-latest#az-acr-build>